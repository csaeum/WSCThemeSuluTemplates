{#
    Block: wsc-columns
    Flexibles Spalten-Layout mit verschachtelten Blöcken
#}

{% set columns = block.columns|default([]) %}

{# Row Einstellungen #}
{% set gutter = block.gutter|default('g-3') %}
{% set rowAlignVertical = block.row_align_vertical|default('') %}
{% set rowAlignHorizontal = block.row_align_horizontal|default('') %}

{# Margin #}
{% set marginTop = block.margin_top|default('mt-3') %}
{% set marginBottom = block.margin_bottom|default('mb-3') %}
{% set marginStart = block.margin_start|default('ms-0') %}
{% set marginEnd = block.margin_end|default('me-0') %}

{# Padding #}
{% set paddingTop = block.padding_top|default('pt-0') %}
{% set paddingBottom = block.padding_bottom|default('pb-0') %}
{% set paddingStart = block.padding_start|default('ps-0') %}
{% set paddingEnd = block.padding_end|default('pe-0') %}

{# Erweiterte Optionen #}
{% set cssClass = block.css_class|default('') %}
{% set htmlId = block.html_id|default('') %}

{# Wrapper-Klassen (Spacing) #}
{% set wrapperClasses = [] %}
{% if marginTop != 'mt-0' %}
    {% set wrapperClasses = wrapperClasses|merge([marginTop]) %}
{% endif %}
{% if marginBottom != 'mb-0' %}
    {% set wrapperClasses = wrapperClasses|merge([marginBottom]) %}
{% endif %}
{% if marginStart != 'ms-0' %}
    {% set wrapperClasses = wrapperClasses|merge([marginStart]) %}
{% endif %}
{% if marginEnd != 'me-0' %}
    {% set wrapperClasses = wrapperClasses|merge([marginEnd]) %}
{% endif %}
{% if paddingTop != 'pt-0' %}
    {% set wrapperClasses = wrapperClasses|merge([paddingTop]) %}
{% endif %}
{% if paddingBottom != 'pb-0' %}
    {% set wrapperClasses = wrapperClasses|merge([paddingBottom]) %}
{% endif %}
{% if paddingStart != 'ps-0' %}
    {% set wrapperClasses = wrapperClasses|merge([paddingStart]) %}
{% endif %}
{% if paddingEnd != 'pe-0' %}
    {% set wrapperClasses = wrapperClasses|merge([paddingEnd]) %}
{% endif %}
{% if cssClass is not empty %}
    {% set wrapperClasses = wrapperClasses|merge([cssClass]) %}
{% endif %}

{# Row-Klassen #}
{% set rowClasses = ['row'] %}
{% if gutter is not empty %}
    {% set rowClasses = rowClasses|merge([gutter]) %}
{% endif %}
{% if rowAlignVertical is not empty %}
    {% set rowClasses = rowClasses|merge([rowAlignVertical]) %}
{% endif %}
{% if rowAlignHorizontal is not empty %}
    {% set rowClasses = rowClasses|merge([rowAlignHorizontal]) %}
{% endif %}

{# Finale Klassen-Strings #}
{% set wrapperClassString = wrapperClasses|join(' ') %}
{% set rowClassString = rowClasses|join(' ') %}

{% if columns|length > 0 %}
<div{% if htmlId %} id="{{ htmlId }}"{% endif %}{% if wrapperClassString %} class="{{ wrapperClassString }}"{% endif %}>
    <div class="{{ rowClassString }}">
        {% for column in columns %}
            {# Spalten-Klassen #}
            {% set colWidth = column.col_width|default('col-md-6') %}
            {% set colAlign = column.col_align|default('') %}
            {% set colCssClass = column.col_css_class|default('') %}
            {% set colHtmlId = column.col_html_id|default('') %}
            
            {% set colClasses = [colWidth] %}
            {% if colAlign is not empty %}
                {% set colClasses = colClasses|merge([colAlign]) %}
            {% endif %}
            {% if colCssClass is not empty %}
                {% set colClasses = colClasses|merge([colCssClass]) %}
            {% endif %}
            {% set colClassString = colClasses|join(' ') %}
            
            <div{% if colHtmlId %} id="{{ colHtmlId }}"{% endif %} class="{{ colClassString }}">
                {# Verschachtelte Blöcke rendern #}
                {% if column.column_blocks is defined and column.column_blocks|length > 0 %}
                    {% for innerBlock in column.column_blocks %}
                        {% set block = innerBlock %}
                        {% include 'wsc/blocks/' ~ innerBlock.type ~ '.html.twig' %}
                    {% endfor %}
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}
